# 自定义BTC数据下载脚本使用指南

## 脚本功能

`download_btc_custom.sh` 是一个交互式脚本，允许您自定义下载BTC数据的年份和月份范围。

## 使用方法

### 1. 运行脚本

```bash
cd crytata
./download_btc_custom.sh
```

### 2. 输入参数

脚本会提示您输入以下参数：

- **年份** (默认: 2025)
  - 输入要下载数据的年份
  - 直接回车使用默认值2025

- **开始月份** (1-12)
  - 输入开始月份，必须是1-12之间的数字
  - 例如：6

- **结束月份** (1-12)
  - 输入结束月份，必须是1-12之间的数字
  - 例如：7

### 3. 确认下载

脚本会显示下载配置并询问是否确认：
```
📅 下载配置:
  年份: 2025
  月份: 6 到 7
  月份列表: 6 7
📁 数据将保存到: /path/to/data/btc_2025_6_to_7

确认开始下载? (y/n):
```

输入 `y` 或 `Y` 开始下载，输入其他任何内容取消下载。

## 示例使用

### 示例1: 下载2025年6-7月数据

```bash
$ ./download_btc_custom.sh
🚀 自定义BTC数据下载脚本...

请输入年份 (默认: 2025): 2025
请输入开始月份 (1-12): 6
请输入结束月份 (1-12): 7

📅 下载配置:
  年份: 2025
  月份: 6 到 7
  月份列表: 6 7
📁 数据将保存到: /path/to/data/btc_2025_6_to_7

确认开始下载? (y/n): y
```

### 示例2: 下载2024年全年数据

```bash
$ ./download_btc_custom.sh
🚀 自定义BTC数据下载脚本...

请输入年份 (默认: 2025): 2024
请输入开始月份 (1-12): 1
请输入结束月份 (1-12): 12

📅 下载配置:
  年份: 2024
  月份: 1 到 12
  月份列表: 1 2 3 4 5 6 7 8 9 10 11 12
📁 数据将保存到: /path/to/data/btc_2024_1_to_12

确认开始下载? (y/n): y
```

### 示例3: 下载2023年Q4数据

```bash
$ ./download_btc_custom.sh
🚀 自定义BTC数据下载脚本...

请输入年份 (默认: 2025): 2023
请输入开始月份 (1-12): 10
请输入结束月份 (1-12): 12

📅 下载配置:
  年份: 2023
  月份: 10 到 12
  月份列表: 10 11 12
📁 数据将保存到: /path/to/data/btc_2023_10_to_12

确认开始下载? (y/n): y
```

## 下载的数据类型

脚本会下载以下所有数据类型：

1. **现货K线数据** (1m, 3m, 5m, 15m, 1h, 4h, 1d)
2. **期货K线数据** (1m, 3m, 5m, 15m, 1h, 4h, 1d)
3. **现货交易数据**
4. **期货交易数据**
5. **期货标记价格K线数据**
6. **期货指数价格K线数据**
7. **期货溢价指数K线数据**

## 目录结构

下载完成后，数据会保存在以下目录结构中：

```
data/btc_{YEAR}_{START_MONTH}_to_{END_MONTH}/
├── spot/
│   ├── klines/
│   │   ├── 1m/
│   │   ├── 3m/
│   │   ├── 5m/
│   │   ├── 15m/
│   │   ├── 1h/
│   │   ├── 4h/
│   │   └── 1d/
│   └── trades/
└── futures/
    ├── klines/
    ├── trades/
    ├── markPriceKlines/
    ├── indexPriceKlines/
    └── premiumPriceKlines/
```

## 数据处理

下载完成后，可以运行处理脚本为CSV文件添加header：

```bash
cd ../binance-public-data/python
python3 process_btc_data.py ../crytata/data/btc_{YEAR}_{START_MONTH}_to_{END_MONTH}
```

## 注意事项

1. **输入验证**: 脚本会验证月份输入的有效性
2. **避免重复下载**: 使用 `-skip-daily 1` 参数避免下载每日数据
3. **时间范围限制**: 使用 `-startDate` 和 `-endDate` 参数限制下载范围
4. **网络连接**: 确保有稳定的网络连接
5. **存储空间**: 根据月份范围，数据大小会有所不同

## 错误处理

- **无效月份**: 如果输入无效月份，脚本会提示错误并退出
- **月份顺序**: 如果开始月份大于结束月份，脚本会提示错误并退出
- **网络错误**: 如果下载过程中出现网络错误，脚本会继续尝试下载其他数据

## 高级用法

### 批量下载多个时间段

可以创建多个脚本来批量下载不同时间段的数据：

```bash
# 下载2024年Q1
./download_btc_custom.sh  # 输入: 2024, 1, 3

# 下载2024年Q2
./download_btc_custom.sh  # 输入: 2024, 4, 6

# 下载2024年Q3
./download_btc_custom.sh  # 输入: 2024, 7, 9

# 下载2024年Q4
./download_btc_custom.sh  # 输入: 2024, 10, 12
``` 